## Assignment1 : Alignment and Phylogenetic Reconstruction (15 marks)

Due date: 4th April 2025

Your name (UPI)


## Instruction

Please write a report using this template and save it into the PDF format. 
You can either use [Overleaf](https://www.overleaf.com), or MS Word, or Google Doc, and then export the completed report as a PDF file. The PDF file name must contain your name and UPI.

You can simply copy this template, and then replace the author into your name in the header above, including UPI insider the bracket.

Please follow the provided instructions carefully to set up the analysis and answer all questions, which are numbered using Roman numerals, such as **Question i:**.
One point for each question, and one bonus point for **clarity** and producing a well-written report.

Your responses to questions should be inside the answer blocks.
Ensure that no answer blocks are overlooked, with the exception of the example provided below.
Substitute 'Your answer' with your actual response to each question, limiting your answers to a maximum of 150 words.
For questions that necessitate a screenshot, please ensure that the image is clear and legible.

**Answer starts:**

Your answer

**Answer ends**

Ensure you answer all questions and submit your report in the PDF format.
Before submitting, please verify that your report opens and displays correctly.

Additionally, it's beneficial to include all relevant figures in your answers, along with the log files and tree files associated with your analysis.

For example, iqtree's tree file (e.g., `*.treefile`) and log file (e.g., `*.log`).

To minimize the size of your submission, consider compressing the files, ensuring to use only the ZIP format for compatibility. 


## Data and methods

We will conduct two analyses on two different dataset - one  method, and the second .



Please download the [alignment](./data/nz_cluster.fasta) of one of largest SARS-CoV-2 clusters in Aotearoa New Zealand ([Geoghegan et al. 2020](https://www.nature.com/articles/s41467-020-20235-8#MOESM3)). The alignment consists of 81 SARS-CoV-2 genome sequences from infected patients, where the label contains the meta data of each sequence, such as the sample location by DHB, lineage, the collection date, etc. We will employ the maximum likelihood method using iqtree to produce a phylogenetic tree, and apply another software, TempEst, to explore the temporal signal.



## 1. Tree-based Alignment (4 points)





http://wasabiapp.org/software/prank/

https://academic.oup.com/mbe/article/33/4/1126/2579418
















## 2. Maximum likelihood tree (5 points)

Run [iqtree2](http://www.iqtree.org/#download) on the dataset to construct a maximum likelihood tree, using the command `iqtree -s nz_cluster.fasta`.
Please attach the maximum likelihood tree file (e.g., "nz_cluster.treefile") and iqtree log file (e.g., "nz_cluster.log") with the report.

For the detail, please read the online documentation and tutorials of iqtree2.

### 2.1 Identify the "best-fit" model

Iqtree2 offers a wide range of DNA substitution models.
Upon execution, it leverages ModelFinder to identify the optimal model for your data, subsequently building the tree using this model.

<br>

**Question i:** By referring to the iqtree log file (e.g., "nz_cluster.log"), what was the "best-fit" substitution model? What was its log-likelihood?
Please provide a brief, yet precise, description of the selected model.

**Answer starts:**

Your answer

**Answer ends**

### 2.2 Results

**Question ii:** Please visualize the maximum likelihood tree, and attach the image with your answer below. The branches are preferred to be coloured by sample locations (0.5 point). The tip labels must be visible.
What are the units of branch length in this maximum likelihood tree?

**Answer starts:**

Your answer

**Answer ends**


## 3. Investigate temporal signal (6 points)

We will now employ [TempEst](http://tree.bio.ed.ac.uk/software/tempest/) to analyse the temporal signal and 'clock-likeness' of the maximum likelihood tree generated by iqtree2.
TempEst is specially designed for analysing trees that have not been inferred under a molecular-clock assumption to see how valid this assumption may be.
Additionally, it identifies the optimal root of the tree at the position that is likely to be the most compatible with the assumption of the molecular clock.

If you are unsure how to answer the following questions, please refer to the article by [Rambaut et al 2016](https://doi.org/10.1093/ve/vew007).

Launch TempEst and import the maximum likelihood tree file.
Record and familiarize yourself with the statistics displayed in the top left conner of the interface.

Then, select "Parse Date" and replicate the settings shown in the following image to extract years from taxon labels.

![Fig 1: parse date](./figs/ParseDates.png){width="500px"}

<br>

Navigate to the "Tree" tab to view the visualized tree, and proceed to the "Root-to-tip" tab to understand the implications of the regression analysis results

Next, activate the "best-fitting root" option in the top-left corner to root the tree at the position most congruent with the molecular clock hypothesis, utilizing the default "heuristic residual mean squared" function.

Report the differences between two trees according to the guidelines provided below.

### 3.1. Statistical results

Record both statistical results before and after ticking the "best-fitting root" option by text.
Pick up a statistic from them, which you think it is reasonable for this dataset.
Explain their implications, and compare them with the analysis each other.

<br>

**Question i:**

-   Record the statistical outcomes both prior to and subsequent to activating the 'best-fitting root' option by text.
-   Explain the implications of two key statistics, "Slope (rate)" and "X-Intercept (TMRCA)",
-   Compare their impact on the analysis before and after the application of the 'best-fitting' model.

**Answer starts:**

Your answer

**Answer ends**

### 3.2. The "best-fitting root" tree

After activating the "best-fitting root" option, navigate to the "Tree" tab.

<br>

**Question ii:**

-   Provide a screenshot of the "best-fitting root" tree.
-   Briefly (in a few sentences) describe the benefits for analysing this dataset using the "best-fitting root" option comparing with the maximum likelihood method.

**Answer starts:**

Your answer

**Answer ends**

<br>

**Question iii:**

-   Look at both the "best-fitting root" tree and the root-to-tip plot, identify at least two problematic clades or taxa in the tree
-   Explain the indication of the problem by considering its position in the root-to-tip plot.

**Answer starts:**

Your answer

**Answer ends**

### 3.3. Exploring temporal signal

As [Rambaut et al 2016](https://doi.org/10.1093/ve/vew007) demonstrated, regression of root-to-tip genetic distance against sampling time can be used as a simple diagnostic tool for molecular clock models.

Keep the same option in TempEst, navigate to the "Root-to-tip" tab, and answer the following questions.

<br>

**Question iv:** Does this dataset contain enough temporal signal. Why or why not?

Use the number and figure to support your conclusion.

**Answer starts:**

Your answer

**Answer ends**

<br>

**Question v:** How can you improve this analysis to increase the temporal signal in the data? 

**Answer starts:**

Your answer

**Answer ends**


